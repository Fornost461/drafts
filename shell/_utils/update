#!/bin/sh

PROG_NAME='~/bin/_utils/update'

printf '\n${PROG_NAME}: info: %s\n\n' 'Use xterm to be able to scroll.'

printf "${PROG_NAME}: debug: %s\n" 'Updating mirror list with reflector.'
sudo reflector --sort score --save /etc/pacman.d/mirrorlist || printf "${PROG_NAME}: error: %s\n" "reflector returned code ${?}"

printf "${PROG_NAME}: debug: %s\n\n" 'Updating packages with pacman.'
if sudo pacman -Syu --noprogressbar; then
    printf "\n${PROG_NAME}: debug: %s\n\n" 'Updating ruby gems.'
    gem update || printf "${PROG_NAME}: error: %s\n" "gem returned code ${?}"
else
    printf "${PROG_NAME}: error: %s\n" "pacman returned code ${?}"
fi
